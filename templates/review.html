{% with messages = get_flashed_messages() %}
    {% if messages %}
        <script>
            alert("{{messages[-1]}}")
        </script>
    {% endif %}
{% endwith %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>What's Your Choices?</title>
    <meta name="description"
          content="software Bootcamp 정보를 모아 한 눈에 비교하고, 수강생들의 후기 및 각 Bootcamp별 평점을 확인할 수 있는 웹 어플리케이션"/>
    <meta name="author" content="hanghae99-28"/>
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/4c48d1e1c1.js" crossorigin="anonymous"></script>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Yeon+Sung&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;600;700&display=swap" rel="stylesheet"/>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"
    ></script>
    <script
            src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"
    ></script>
    <!-- CSS -->
    <link href="{{ url_for('static', filename='styles/style.css') }}" rel="stylesheet"/>
    <!-- JavaScript -->
    <script src="{{ url_for('static',filename='javascripts/main.js') }}"></script>
    <script src="{{ url_for('static',filename='javascripts/review.js') }}"></script>
</head>
<body>
<!-- Navbar -->
<nav id="navbar" class="navcol">
    <div class="nav-wrap">
        <img class="teamLogo" src="{{ url_for('static', filename='image/your_choice.png') }}" alt="yourChoice_logo">
        <h1 class="home__title title">
            <a href="/" class="color-a">
                What is your choice?
            </a>
        </h1>
    </div>
    <div class="nav-second-wrap">
        <ul class="navbar__menu">
{#            <li class="navbar__menu__item nav-btn" data-link="#home" id="sign_in"><a href="/login">로그인</a></li>#}
{#            <li class="navbar__menu__item nav-btn" data-link="#about" id="sign_up"><a href="/signup">회원가입</a></li>#}
{#            <li class="navbar__menu__item nav-btn" data-link="#about" id="sign_out"><a href="/">로그아웃</a></li>#}
        </ul>
    </div>
</nav>
<!-- Home -->
<section id="home">
</section>
<section id="review">
    <div class="review__detail">
        <div class="review__detail--container">
            {% for camp in camps %}
                <img src={{ url_for('static', filename='image/' + camp['boot_img']) }} alt={{ camp['id'] }}
                     id={{ camp['id'] }} class="boot_logo"/>
                <div class="review__detail--info">
                    <a href={{ camp['link'] }} id="boot_name">{{ camp['name'] }}</a>
                    <p>지향 : <span id="direction">{{ camp['direction'] }}</span></p>
                    <p>언어 : <span id="lang">{{ camp['lang'] }}</span></p>
                    <p>입학시험 : <span id="istest">{{ camp['istest'] }}</span></p>
                    <p>비용 : <span id="tuition">{{ camp['tuition'] }}</span></p>
                    <p>기간 : <span id="period">{{ camp['period'] }}</span></p>
                </div>
            {% endfor %}
        </div>

        <div class="review__write">
            <span id="overall">
                        만족도
                        <input type="radio" id="overall1" name="review_overall" value="review_overall"/>
                        <label for="overall1">1</label>
                        <input type="radio" id="overall2" name="review_overall" value="review_overall"/>
                        <label for="overall2">2</label>
                        <input type="radio" id="overall3" name="review_overall" value="review_overall"/>
                        <label for="overall3">3</label>
                        <input type="radio" id="overall4" name="review_overall" value="review_overall"/>
                        <label for="overall4">4</label>
                        <input type="radio" id="overall5" name="review_overall" value="review_overall"/>
                        <label for="overall5">5</label>
                    </span>
            <span id="period">
                        기간
                        <input type="radio" id="period1" name="reivew_period" value="reivew_period"/>
                        <label for="period1">1</label>
                        <input type="radio" id="period2" name="reivew_period" value="reivew_period"/>
                        <label for="period2">2</label>
                        <input type="radio" id="period3" name="reivew_period" value="reivew_period"/>
                        <label for="period3">3</label>
                        <input type="radio" id="period4" name="reivew_period" value="reivew_period"/>
                        <label for="period4">4</label>
                        <input type="radio" id="period5" name="reivew_period" value="reivew_period"/>
                        <label for="period5">5</label>
                    </span>
            <span id="recommend">
                        추천 의향
                        <input type="radio" id="recommend1" name="review_recommend" value="review_recommend"/>
                        <label for="recommend1">1</label>
                        <input type="radio" id="recommend2" name="review_recommend" value="review_recommend"/>
                        <label for="recommend2">2</label>
                        <input type="radio" id="recommend3" name="review_recommend" value="review_recommend"/>
                        <label for="recommend3">3</label>
                        <input type="radio" id="recommend4" name="review_recommend" value="review_recommend"/>
                        <label for="recommend4">4</label>
                        <input type="radio" id="recommend5" name="review_recommend" value="review_recommend"/>
                        <label for="recommend5">5</label>
                    </span>
            <span id="tuition">
                        비용
                        <input type="radio" id="tuition1" name="review_tuition" value="review_tuition"/>
                        <label for="tuition1">1</label>
                        <input type="radio" id="tuition2" name="review_tuition" value="review_tuition"/>
                        <label for="tuition2">2</label>
                        <input type="radio" id="tuition3" name="review_tuition" value="review_tuition"/>
                        <label for="tuition3">3</label>
                        <input type="radio" id="tuition4" name="review_tuition" value="review_tuition"/>
                        <label for="tuition4">4</label>
                        <input type="radio" id="tuition5" name="review_tuition" value="review_tuition"/>
                        <label for="tuition5">5</label>
                    </span>

            <textarea name="review_comment" form="inform" id="review_comment" cols="80" rows="4"></textarea>
            <button class="review__btn">등록</button>
        </div>
        <div id="review__list">
            {% for review in reviews %}
                <div class="review__list--col">
                    <div class="comment">
                        <span>{{ review.comment }}</span>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>
<script>
    let camps = {{camps | tojson}}[0];
    let reviews = {{reviews | tojson}}[0];

    let campId = document.querySelector('.boot_logo').getAttribute('id');
    let author = null;

    let overalls = document.querySelectorAll('#overall > label');
    let periods = document.querySelectorAll('#period > label');
    let recommends = document.querySelectorAll('#recommend > label');
    let tuitions = document.querySelectorAll('#tuition > label');
    let commentBox = document.querySelector('#review_comment');
    let submitBtn = document.querySelector('.review__btn');

    clickEvent(overalls);
    clickEvent(periods);
    clickEvent(recommends);
    clickEvent(tuitions);

    let reviewList = {
        overall: null,
        period: null,
        recommend: null,
        tuition: null,
        comment: "",
    };

    let overall, period, recommend, tuition, avg = null;
    let comment = '';

    submitBtn.addEventListener('click', () => {
        getCommentReview();
        seperateReviewList(reviewList);
        postReview();
    })

    function postReview() {
        $.ajax({
            type: 'POST',
            url: '/api/review/',
            data: {
                author_give: author,
                campId_give: campId,
                overall_give: overall,
                period_give: period,
                recommend_give: recommend,
                tuition_give: tuition,
                comment_give: comment,
                avg_give: avg,
            },
            success: function (response) {
                alert(response['msg']);
                location.reload();
            }
        })
    }

    $('.home__title').click(function () {
        window.location.href = '/';
    });
</script>
</body>
</html>